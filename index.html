<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Свадебная рассадка гостей</title>
    <style>
        /* Все стили остаются без изменений */
        body {
            font-family: 'Playfair Display', serif;
            margin: 0;
            padding: 20px;
            min-height: 100vh;
            color: #5d3a4a;
            background: #fff9fb url('assets/wedding-bg.jpg') center/cover fixed;
            position: relative;
            overflow-x: hidden;
        }
        /* ... остальные стили ... */
    </style>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500;600&display=swap" rel="stylesheet">
</head>
<body>
    <h1>Рассадка гостей</h1>
    
    <div class="tables-wrapper">
        <div class="tables-container" id="tablesContainer"></div>
    </div>
    
    <div id="guestModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal()">&times;</span>
            <h2 id="guestTitle">Информация о госте</h2>
            <div id="guestInfo"></div>
            <div class="edit-form">
                <textarea id="guestNotesInput" placeholder="Добавьте описание гостя..."></textarea>
                <button class="btn" onclick="saveGuestNotes()">Сохранить описание</button>
            </div>
        </div>
    </div>

    <script>
        // Актуальная база гостей (версия 2.2)
        const guestsDB = {
            1: {name: "Швайко Алена", table: 1, notes: ""},
            2: {name: "Швайко Илья", table: 1, notes: ""},
            3: {name: "Швайко Кристина", table: 1, notes: ""},
            4: {name: "Швайко Никита", table: 1, notes: ""},
            5: {name: "Бирюзова Алена", table: 1, notes: ""},
            6: {name: "Бирюзова Анфиса", table: 1, notes: ""},
            26: {name: "Елькина Софья", table: 1, notes: ""}, // Перемещена со стола 4
            9: {name: "Лемеш Анастасия", table: 2, notes: ""},
            10: {name: "Кокарева Нина", table: 2, notes: ""},
            11: {name: "Кокарев Анатолий", table: 2, notes: ""},
            12: {name: "Женихова Анна", table: 2, notes: ""},
            13: {name: "Женихов Владимир", table: 2, notes: ""},
            14: {name: "Женихова Таня", table: 2, notes: ""},
            15: {name: "Грушина Елена", table: 2, notes: ""},
            16: {name: "Майзерова Светлана", table: 2, notes: ""},
            17: {name: "Гусева Елена", table: 3, notes: ""},
            18: {name: "Гусев Владимир", table: 3, notes: ""},
            19: {name: "Майзерова Елена", table: 3, notes: ""},
            20: {name: "Майзеров Сергей", table: 3, notes: ""},
            21: {name: "Майзерова Татьяна", table: 3, notes: ""},
            22: {name: "Моторкина Валентина", table: 3, notes: ""},
            23: {name: "Гусева Татьяна", table: 3, notes: ""},
            24: {name: "Галиева Ольга", table: 3, notes: ""},
            25: {name: "Майзерова Александра", table: 4, notes: ""},
            27: {name: "Лемеш София", table: 4, notes: ""},
            28: {name: "Иванов Максим", table: 4, notes: ""},
            29: {name: "Хошева Елена", table: 4, notes: ""},
            30: {name: "Лемеш Олег", table: 4, notes: ""},
            31: {name: "Лемеш Ирина", table: 4, notes: ""},
            32: {name: "Галиев Григорий", table: 4, notes: ""},
            41: {name: "Семен Сендерик", table: 4, notes: ""}, // Новый гость
            33: {name: "Александров Борис", table: 5, notes: ""},
            34: {name: "Гребенникова Полина", table: 5, notes: ""},
            35: {name: "Крутова Марина", table: 5, notes: ""},
            36: {name: "Бусарова Дарья", table: 5, notes: ""},
            37: {name: "Некрасов Валентин", table: 5, notes: ""},
            38: {name: "Некрасова Дарья", table: 5, notes: ""},
            39: {name: "Горончук Андрей", table: 5, notes: ""},
            40: {name: "Горончук Любовь", table: 5, notes: ""}
        };

        let currentGuestId = null;

        // Система контроля версий данных
        function clearOldData() {
            const savedVersion = localStorage.getItem('weddingDataVersion');
            const currentVersion = '2.2'; // Обновлено из-за изменений
            if (savedVersion !== currentVersion) {
                localStorage.removeItem('weddingGuests');
                localStorage.setItem('weddingDataVersion', currentVersion);
            }
        }

        function initPage() {
            clearOldData();
            const savedData = localStorage.getItem('weddingGuests');
            if (savedData) Object.assign(guestsDB, JSON.parse(savedData));
            generateSeating();
        }

        function generateSeating() {
            const container = document.getElementById('tablesContainer');
            container.innerHTML = '';
            
            const tablesCount = Math.max(...Object.values(guestsDB).map(g => g.table));
            
            for (let tableNum = 1; tableNum <= tablesCount; tableNum++) {
                const tableDiv = document.createElement('div');
                tableDiv.className = 'table';
                tableDiv.innerHTML = `<h2>Стол ${tableNum}</h2>`;
                
                Object.entries(guestsDB)
                    .filter(([_, guest]) => guest.table == tableNum)
                    .sort((a, b) => a[0] - b[0])
                    .forEach(([id, guest]) => {
                        const guestDiv = document.createElement('div');
                        guestDiv.className = 'guest';
                        guestDiv.textContent = guest.name;
                        guestDiv.addEventListener('click', () => showGuestInfo(id));
                        tableDiv.appendChild(guestDiv);
                    });
                
                container.appendChild(tableDiv);
            }
        }

        function showGuestInfo(guestId) {
            currentGuestId = guestId;
            const guest = guestsDB[guestId];
            document.getElementById('guestTitle').textContent = guest.name;
            document.getElementById('guestInfo').innerHTML = `
                <p><strong>Стол:</strong> ${guest.table}</p>
                ${guest.notes ? `<p><strong>Описание:</strong> ${guest.notes}</p>` : '<p><em>Описание отсутствует</em></p>'}
            `;
            document.getElementById('guestNotesInput').value = guest.notes || '';
            document.getElementById('guestModal').style.display = 'block';
        }

        function saveGuestNotes() {
            if (!currentGuestId) return;
            const notesInput = document.getElementById('guestNotesInput');
            guestsDB[currentGuestId].notes = notesInput.value.trim();
            localStorage.setItem('weddingGuests', JSON.stringify(guestsDB));
            showGuestInfo(currentGuestId);
        }

        function closeModal() {
            document.getElementById('guestModal').style.display = 'none';
        }

        window.onclick = (event) => {
            if (event.target == document.getElementById('guestModal')) closeModal();
        };

        document.addEventListener('DOMContentLoaded', initPage);
    </script>
</body>
</html>
